--========================================================
--  IKAN TONGKOL â€” Standalone UI (tanpa tab)
--  Satu file, tanpa require/module, siap upload GitHub
--========================================================

-- Services
local UserInputService = game:GetService("UserInputService")
local TweenService     = game:GetService("TweenService")
local RunService       = game:GetService("RunService")
local Players          = game:GetService("Players")
local LocalPlayer      = Players.LocalPlayer
local Mouse            = LocalPlayer:GetMouse()
local HttpService      = game:GetService("HttpService")

--====================  CORE LIB  ========================--
local IkanTongkolLib = {
	Elements      = {},
	ThemeObjects  = {},
	Connections   = {},
	Flags         = {},
	Themes = {
		Default = {
			Main     = Color3.fromRGB(25, 25, 25),
			Second   = Color3.fromRGB(32, 32, 32),
			Stroke   = Color3.fromRGB(60, 60, 60),
			Divider  = Color3.fromRGB(60, 60, 60),
			Text     = Color3.fromRGB(240, 240, 240),
			TextDark = Color3.fromRGB(150, 150, 150)
		}
	},
	SelectedTheme = "Default",
	Folder        = nil,
	SaveCfg       = false
}

--====================  ICONS  ===========================--
local Icons = {}
pcall(function()
	local raw = game:HttpGetAsync("https://raw.githubusercontent.com/evoincorp/lucideblox/master/src/modules/util/icons.json")
	Icons = HttpService:JSONDecode(raw).icons or {}
end)
local function GetIcon(name) return Icons[name] end

--====================  GUI ROOT  ========================--
local Root = Instance.new("ScreenGui")
Root.Name = "IkanTongkol"
if syn and syn.protect_gui then
	syn.protect_gui(Root)
	Root.Parent = game:GetService("CoreGui")
else
	local ok, ui = pcall(function() return gethui() end)
	Root.Parent = (ok and ui) or game:GetService("CoreGui")
end

-- kill duplicates
for _, v in ipairs(Root.Parent:GetChildren()) do
	if v ~= Root and v.Name == Root.Name then v:Destroy() end
end

function IkanTongkolLib:IsRunning()
	local ok, ui = pcall(function() return gethui() end)
	return Root.Parent == ((ok and ui) or game:GetService("CoreGui"))
end

local function AddConnection(sig, fn)
	if not IkanTongkolLib:IsRunning() then return end
	local c = sig:Connect(fn)
	table.insert(IkanTongkolLib.Connections, c)
	return c
end

task.spawn(function()
	while IkanTongkolLib:IsRunning() do task.wait() end
	for _, c in next, IkanTongkolLib.Connections do pcall(function() c:Disconnect() end) end
end)

--====================  HELPERS  =========================--
local function Create(Name, Props, Children)
	local o = Instance.new(Name)
	for k,v in next, (Props or {}) do o[k] = v end
	for _,ch in next, (Children or {}) do ch.Parent = o end
	return o
end

local function CreateElement(id, fn) IkanTongkolLib.Elements[id] = function(...) return fn(...) end end
local function MakeElement(id, ...) return IkanTongkolLib.Elements[id](...) end
local function SetProps(obj, props) for k,v in next, props do obj[k] = v end; return obj end
local function SetChildren(obj, kids) for _,k in next, kids do k.Parent = obj end; return obj end

local function Round(n, step) local r = math.floor(n/step + (math.sign(n)*0.5))*step; if r < 0 then r = r + step end; return r end
local function ReturnProperty(o)
	if o:IsA("Frame") or o:IsA("TextButton") then return "BackgroundColor3" end
	if o:IsA("ScrollingFrame")             then return "ScrollBarImageColor3" end
	if o:IsA("UIStroke")                   then return "Color" end
	if o:IsA("TextLabel") or o:IsA("TextBox") then return "TextColor3" end
	if o:IsA("ImageLabel") or o:IsA("ImageButton") then return "ImageColor3" end
end
local function AddThemeObject(obj, typeName)
	IkanTongkolLib.ThemeObjects[typeName] = IkanTongkolLib.ThemeObjects[typeName] or {}
	table.insert(IkanTongkolLib.ThemeObjects[typeName], obj)
	obj[ReturnProperty(obj)] = IkanTongkolLib.Themes[IkanTongkolLib.SelectedTheme][typeName]
	return obj
end

-- cfg utils (executor fs API)
local function PackColor(c) return {R=c.R*255,G=c.G*255,B=c.B*255} end
local function UnpackColor(t) return Color3.fromRGB(t.R, t.G, t.B) end

local function LoadCfg(raw)
	local data = HttpService:JSONDecode(raw)
	for name, val in pairs(data) do
		local flag = IkanTongkolLib.Flags[name]
		if flag then
			task.spawn(function()
				if flag.Type == "Colorpicker" then flag:Set(UnpackColor(val)) else flag:Set(val) end
			end)
		else
			warn("IkanTongkol Config Loader: flag tidak ditemukan", name)
		end
	end
end

local function SaveCfg(name)
	local data = {}
	for k,flag in pairs(IkanTongkolLib.Flags) do
		if flag.Save then data[k] = (flag.Type=="Colorpicker") and PackColor(flag.Value) or flag.Value end
	end
	writefile(IkanTongkolLib.Folder.."/"..name..".txt", HttpService:JSONEncode(data))
end

local WhitelistedMouse = {Enum.UserInputType.MouseButton1, Enum.UserInputType.MouseButton2, Enum.UserInputType.MouseButton3}
local BlacklistedKeys  = {Enum.KeyCode.Unknown,Enum.KeyCode.W,Enum.KeyCode.A,Enum.KeyCode.S,Enum.KeyCode.D,Enum.KeyCode.Up,Enum.KeyCode.Left,Enum.KeyCode.Down,Enum.KeyCode.Right,Enum.KeyCode.Slash,Enum.KeyCode.Tab,Enum.KeyCode.Backspace,Enum.KeyCode.Escape}
local function CheckKey(t, key) for _,v in next, t do if v==key then return true end end end

-- dragging
local function AddDrag(DragPoint, Main)
	pcall(function()
		local dragging, dragInput, mousePos, framePos = false
		DragPoint.InputBegan:Connect(function(input)
			if input.UserInputType == Enum.UserInputType.MouseButton1 then
				dragging = true; mousePos = input.Position; framePos = Main.Position
				input.Changed:Connect(function() if input.UserInputState == Enum.UserInputState.End then dragging = false end end)
			end
		end)
		DragPoint.InputChanged:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseMovement then dragInput = input end end)
		UserInputService.InputChanged:Connect(function(input)
			if input == dragInput and dragging then
				local d = input.Position - mousePos
				TweenService:Create(Main, TweenInfo.new(0.45, Enum.EasingStyle.Quint, Enum.EasingDirection.Out),
					{Position = UDim2.new(framePos.X.Scale, framePos.X.Offset + d.X, framePos.Y.Scale, framePos.Y.Offset + d.Y)}):Play()
			end
		end)
	end)
end

-- basic element makers
CreateElement("Corner", function(s,o) return Create("UICorner", {CornerRadius = UDim.new(s or 0, o or 10)}) end)
CreateElement("Stroke", function(c,t) return Create("UIStroke", {Color = c or Color3.new(1,1,1), Thickness = t or 1}) end)
CreateElement("List",   function(s,o) return Create("UIListLayout", {SortOrder = Enum.SortOrder.LayoutOrder, Padding = UDim.new(s or 0, o or 0)}) end)
CreateElement("Padding",function(b,l,r,t) return Create("UIPadding", {
	PaddingBottom = UDim.new(0, b or 4), PaddingLeft = UDim.new(0, l or 4),
	PaddingRight = UDim.new(0, r or 4),  PaddingTop  = UDim.new(0, t or 4)}) end)
CreateElement("TFrame", function() return Create("Frame", {BackgroundTransparency = 1}) end)
CreateElement("RoundFrame", function(color, s, o)
	return Create("Frame", {BackgroundColor3 = color or Color3.new(1,1,1), BorderSizePixel = 0}, { Create("UICorner", {CornerRadius = UDim.new(s or 0, o or 10)}) })
end)
CreateElement("Button", function() return Create("TextButton", {Text="", AutoButtonColor=false, BackgroundTransparency=1, BorderSizePixel=0}) end)
CreateElement("ScrollFrame", function(color, width)
	return Create("ScrollingFrame", {
		BackgroundTransparency = 1,
		MidImage = "rbxassetid://7445543667",
		BottomImage = "rbxassetid://7445543667",
		TopImage = "rbxassetid://7445543667",
		ScrollBarImageColor3 = color or Color3.new(1,1,1),
		BorderSizePixel = 0,
		ScrollBarThickness = width or 4,
		CanvasSize = UDim2.new(0,0,0,0)
	})
end)
CreateElement("Image", function(id)
	local img = Create("ImageLabel", {Image=id or "", BackgroundTransparency=1})
	local resolved = GetIcon(id or "")
	if resolved then img.Image = resolved end
	return img
end)
CreateElement("Label", function(text, size, tr)
	return Create("TextLabel", {
		Text = text or "",
		TextSize = size or 15,
		TextColor3 = Color3.fromRGB(240,240,240),
		TextTransparency = tr or 0,
		Font = Enum.Font.Gotham,
		RichText = true,
		BackgroundTransparency = 1,
		TextXAlignment = Enum.TextXAlignment.Left
	})
end)

--====================  NOTIFICATION  ====================--
local NotificationHolder = SetProps(SetChildren(MakeElement("TFrame"), {
	SetProps(MakeElement("List"), {
		HorizontalAlignment = Enum.HorizontalAlignment.Center,
		VerticalAlignment   = Enum.VerticalAlignment.Bottom,
		Padding = UDim.new(0,5)
	})
}), {
	Position    = UDim2.new(1, -25, 1, -25),
	Size        = UDim2.new(0, 300, 1, -25),
	AnchorPoint = Vector2.new(1,1),
	Parent      = Root
})

function IkanTongkolLib:MakeNotification(cfg)
	task.spawn(function()
		cfg = cfg or {}
		cfg.Name    = cfg.Name    or "Notification"
		cfg.Content = cfg.Content or "Test"
		cfg.Image   = cfg.Image   or "bell"
		cfg.Time    = cfg.Time    or 15

		local holder = SetProps(MakeElement("TFrame"), {AutomaticSize = Enum.AutomaticSize.Y, Size = UDim2.new(1,0,0,0), Parent = NotificationHolder})
		local frame = SetChildren(SetProps(MakeElement("RoundFrame", Color3.fromRGB(25,25,25), 0, 10), {
			Parent = holder, AutomaticSize = Enum.AutomaticSize.Y, Size = UDim2.new(1,0,0,0), Position = UDim2.new(1,-55,0,0)
		}), {
			MakeElement("Stroke", Color3.fromRGB(93,93,93), 1.2),
			MakeElement("Padding", 12,12,12,12),
			SetProps(MakeElement("Image", cfg.Image), {Size = UDim2.new(0,20,0,20), ImageColor3 = Color3.fromRGB(240,240,240), Name="Icon"}),
			SetProps(MakeElement("Label", cfg.Name, 15), {Size=UDim2.new(1,-30,0,20), Position=UDim2.new(0,30,0,0), Font=Enum.Font.GothamBold, Name="Title"}),
			SetProps(MakeElement("Label", cfg.Content, 14), {Size=UDim2.new(1,0,0,0), Position=UDim2.new(0,0,0,25), Font=Enum.Font.GothamSemibold, Name="Content", AutomaticSize=Enum.AutomaticSize.Y, TextColor3=Color3.fromRGB(200,200,200), TextWrapped=true})
		})
		TweenService:Create(frame, TweenInfo.new(0.5, Enum.EasingStyle.Quint), {Position=UDim2.new(0,0,0,0)}):Play()
		task.wait(math.max(0.1, cfg.Time - 0.88))
		TweenService:Create(frame.Icon, TweenInfo.new(0.4, Enum.EasingStyle.Quint), {ImageTransparency=1}):Play()
		TweenService:Create(frame, TweenInfo.new(0.8, Enum.EasingStyle.Quint), {BackgroundTransparency=0.6}):Play()
		task.wait(0.3)
		TweenService:Create(frame.UIStroke, TweenInfo.new(0.6, Enum.EasingStyle.Quint), {Transparency=0.9}):Play()
		TweenService:Create(frame.Title,    TweenInfo.new(0.6, Enum.EasingStyle.Quint), {TextTransparency=0.4}):Play()
		TweenService:Create(frame.Content,  TweenInfo.new(0.6, Enum.EasingStyle.Quint), {TextTransparency=0.5}):Play()
		task.wait(0.05)
		frame:TweenPosition(UDim2.new(1,20,0,0), "In", "Quint", 0.8, true)
		task.wait(1.35)
		frame:Destroy()
	end)
end

function IkanTongkolLib:Init()
	if not self.SaveCfg then return end
	pcall(function()
		if isfile(self.Folder.."/"..game.GameId..".txt") then
			LoadCfg(readfile(self.Folder.."/"..game.GameId..".txt"))
			self:MakeNotification({Name="Configuration", Content="Auto-loaded for game "..game.GameId, Time=4})
		end
	end)
end

--====================  WINDOW (NO TAB)  =================--
function IkanTongkolLib:MakeWindow(cfg)
	cfg = cfg or {}
	cfg.Name         = cfg.Name or "IkanTongkol"
	cfg.ConfigFolder = cfg.ConfigFolder or cfg.Name
	cfg.SaveConfig   = cfg.SaveConfig or false
	cfg.HidePremium  = cfg.HidePremium or true
	if cfg.IntroEnabled == nil then cfg.IntroEnabled = true end
	cfg.IntroText    = cfg.IntroText or cfg.Name
	cfg.CloseCallback= cfg.CloseCallback or function() end
	cfg.ShowIcon     = cfg.ShowIcon or false
	cfg.Icon         = cfg.Icon or "rbxassetid://8834748103"
	cfg.IntroIcon    = cfg.IntroIcon or "rbxassetid://8834748103"

	self.Folder  = cfg.ConfigFolder
	self.SaveCfg = cfg.SaveConfig
	if cfg.SaveConfig and not isfolder(cfg.ConfigFolder) then makefolder(cfg.ConfigFolder) end

	local Minimized, UIHidden = false, false

	-- Main Window
	local TopBar = MakeElement("TFrame")
	local BottomBar = MakeElement("TFrame")
	local Container = AddThemeObject(SetChildren(SetProps(MakeElement("ScrollFrame", Color3.fromRGB(255,255,255), 5), {
		Name="ItemContainer", Position = UDim2.new(0, 0, 0, 50), Size = UDim2.new(1, 0, 1, -100), Parent = Root
	}), { MakeElement("List", 0, 6), MakeElement("Padding", 15, 10, 10, 15)}), "Divider")

	local Window = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.fromRGB(255,255,255), 0, 10), {
		Parent   = Root,
		Position = UDim2.new(0.5, -307, 0.5, -172),
		Size     = UDim2.new(0, 615, 0, 344),
		ClipsDescendants = true,
		Name="IkanTongkolWindow"
	}), {
		SetChildren(SetProps(MakeElement("TFrame"), {Size = UDim2.new(1,0,0,50), Name="TopBar"}), {
			AddThemeObject(SetProps(MakeElement("Label", cfg.Name, 14), {Size=UDim2.new(1,-30,2,0), Position=UDim2.new(0,25,0,-24), Font=Enum.Font.GothamBlack, TextSize=20}), "Text"),
			AddThemeObject(SetProps(MakeElement("Frame"), {Size=UDim2.new(1,0,0,1), Position=UDim2.new(0,0,1,-1)}), "Stroke"),
			AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.fromRGB(255,255,255), 0, 7), {
				Size=UDim2.new(0,70,0,30), Position=UDim2.new(1,-90,0,10)
			}), {
				AddThemeObject(MakeElement("Stroke"), "Stroke"),
				AddThemeObject(SetProps(MakeElement("Frame"), {Size=UDim2.new(0,1,1,0), Position=UDim2.new(0.5,0,0,0)}), "Stroke"),
				-- minimize
				SetChildren(SetProps(MakeElement("Button"), {Size=UDim2.new(0.5,0,1,0)}), {
					AddThemeObject(SetProps(MakeElement("Image", "rbxassetid://7072719338"), {Name="Ico", Size=UDim2.new(0,18,0,18), Position=UDim2.new(0,9,0,6)}), "Text")
				}),
				-- close
				SetChildren(SetProps(MakeElement("Button"), {Size=UDim2.new(0.5,0,1,0), Position=UDim2.new(0.5,0,0,0)}), {
					AddThemeObject(SetProps(MakeElement("Image", "rbxassetid://7072725342"), {Size=UDim2.new(0,18,0,18), Position=UDim2.new(0,9,0,6)}), "Text")
				})
			}), "Second")
		}),
		-- content + bottom user bar
		SetChildren(SetProps(MakeElement("TFrame"), {Size=UDim2.new(1,0,0,50), Position=UDim2.new(0,0,1,-50), Name="BottomBar"}), {
			AddThemeObject(SetProps(MakeElement("Frame"), {Size=UDim2.new(1,0,0,1), Position=UDim2.new(0,0,0,0)}), "Stroke"),
			AddThemeObject(SetChildren(SetProps(MakeElement("Frame"), {
				AnchorPoint = Vector2.new(0, 0.5), Size = UDim2.new(0, 32, 0, 32), Position = UDim2.new(0, 10, 0.5, 0)
			}), {
				SetProps(MakeElement("Image", "https://www.roblox.com/headshot-thumbnail/image?userId="..LocalPlayer.UserId.."&width=420&height=420&format=png"), {Size = UDim2.new(1,0,1,0)}),
				AddThemeObject(SetProps(MakeElement("Image", "rbxassetid://4031889928"), {Size=UDim2.new(1,0,1,0)}), "Second"),
				MakeElement("Corner", 1)
			}), "Divider"),
			SetChildren(SetProps(MakeElement("TFrame"), {AnchorPoint=Vector2.new(0,0.5), Size=UDim2.new(0,32,0,32), Position=UDim2.new(0,10,0.5,0)}), {
				AddThemeObject(MakeElement("Stroke"), "Stroke"), MakeElement("Corner", 1)
			}),
			AddThemeObject(SetProps(MakeElement("Label", LocalPlayer.DisplayName, 14), {Size=UDim2.new(1,-60,0,13), Position=UDim2.new(0,50,0,19), Font=Enum.Font.GothamBold}), "Text")
		}),
		Container,
	}), "Main")

	TopBar = Window.TopBar
	BottomBar = Window.BottomBar

	-- optional icon on title
	if cfg.ShowIcon then
		local title = TopBar:FindFirstChildWhichIsA("TextLabel", true)
		title.Position = UDim2.new(0, 50, 0, -24)
		SetProps(MakeElement("Image", cfg.Icon), {Parent=TopBar, Size=UDim2.new(0,20,0,20), Position=UDim2.new(0,25,0,15)})
	end

	-- draggable
	local DragPoint = MakeElement("TFrame"); DragPoint.Size = UDim2.new(1,0,0,50); DragPoint.Parent = Window
	AddDrag(DragPoint, Window)

	-- minimize / close
	local barButtons = TopBar:FindFirstChildOfClass("Frame", true)
	local minimizeBtn = barButtons and barButtons:FindFirstChildWhichIsA("TextButton", true)
	local closeBtn    = barButtons and barButtons:FindFirstChildWhichIsA("TextButton", true) and barButtons:GetChildren()[3]

	AddConnection((closeBtn or Instance.new("BindableEvent")).Event, function() end) -- placeholder if nil
	if closeBtn then
		closeBtn.MouseButton1Up:Connect(function()
			Window.Visible = false; UIHidden = true
			IkanTongkolLib:MakeNotification({Name="Interface Hidden", Content="Tap RightShift untuk membuka lagi", Time=4})
			cfg.CloseCallback()
		end)
	end

	if minimizeBtn then
		minimizeBtn.MouseButton1Up:Connect(function()
			local ico = minimizeBtn:FindFirstChild("Ico")
			if Minimized then
				TweenService:Create(Window, TweenInfo.new(0.5, Enum.EasingStyle.Quint), {Size=UDim2.new(0,615,0,344)}):Play()
				if ico then ico.Image = "rbxassetid://7072719338" end
				task.wait(.02)
				Window.ClipsDescendants = false
				BottomBar.Visible = true
				TopBar:FindFirstChildOfClass("Frame").Visible = true
			else
				Window.ClipsDescendants = true
				TopBar:FindFirstChildOfClass("Frame").Visible = false
				if ico then ico.Image = "rbxassetid://7072720870" end
				TweenService:Create(Window, TweenInfo.new(0.5, Enum.EasingStyle.Quint), {Size=UDim2.new(0, TopBar:FindFirstChildOfClass("TextLabel").TextBounds.X + 140, 0, 50)}):Play()
				task.wait(0.1)
				BottomBar.Visible = false
			end
			Minimized = not Minimized
		end)
	end

	AddConnection(UserInputService.InputBegan, function(input)
		if input.KeyCode == Enum.KeyCode.RightShift and UIHidden then
			Window.Visible = true; UIHidden = false
		end
	end)

	-- intro
	local function Intro()
		Window.Visible = false
		local logo = SetProps(MakeElement("Image", cfg.IntroIcon), {
			Parent=Root, AnchorPoint=Vector2.new(0.5,0.5), Position=UDim2.new(0.5,0,0.4,0), Size=UDim2.new(0,28,0,28),
			ImageColor3=Color3.new(1,1,1), ImageTransparency=1
		})
		local text = SetProps(MakeElement("Label", cfg.IntroText, 14), {
			Parent=Root, Size=UDim2.new(1,0,1,0), AnchorPoint=Vector2.new(0.5,0.5), Position=UDim2.new(0.5,19,0.5,0),
			TextXAlignment=Enum.TextXAlignment.Center, Font=Enum.Font.GothamBold, TextTransparency=1
		})
		TweenService:Create(logo, TweenInfo.new(.3, Enum.EasingStyle.Quad), {ImageTransparency=0, Position=UDim2.new(0.5,0,0.5,0)}):Play()
		task.wait(0.8)
		TweenService:Create(logo, TweenInfo.new(.3, Enum.EasingStyle.Quad), {Position=UDim2.new(0.5, -(text.TextBounds.X/2), 0.5, 0)}):Play()
		task.wait(0.3)
		TweenService:Create(text, TweenInfo.new(.3, Enum.EasingStyle.Quad), {TextTransparency=0}):Play()
		task.wait(2)
		TweenService:Create(text, TweenInfo.new(.3, Enum.EasingStyle.Quad), {TextTransparency=1}):Play()
		Window.Visible = true; logo:Destroy(); text:Destroy()
	end
	if cfg.IntroEnabled then Intro() end

	-- container autosize
	AddConnection(Container.UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"), function()
		Container.CanvasSize = UDim2.new(0,0,0, Container.UIListLayout.AbsoluteContentSize.Y + 30)
	end)

	--========= ELEMENT FACTORY (langsung di Window) =======--
	local function GetElements(ItemParent)
		local E = {}

		function E:AddLabel(text)
			local f = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1),0,5), {
				Parent=ItemParent, Size=UDim2.new(1,0,0,30), BackgroundTransparency=0.7
			}), {
				AddThemeObject(SetProps(MakeElement("Label", text or "Label", 15), {
					Size=UDim2.new(1,-12,1,0), Position=UDim2.new(0,12,0,0), Font=Enum.Font.GothamBold, Name="Content"
				}), "Text"),
				AddThemeObject(MakeElement("Stroke"), "Stroke")
			}), "Second")
			return { Set=function(_,t) f.Content.Text=t end }
		end

		function E:AddParagraph(title, content)
			title = title or "Text"; content = content or "Content"
			local f = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1),0,5), {
				Parent=ItemParent, Size=UDim2.new(1,0,0,30), BackgroundTransparency=0.7
			}), {
				AddThemeObject(SetProps(MakeElement("Label", title, 15), {Size=UDim2.new(1,-12,0,14), Position=UDim2.new(0,12,0,10), Font=Enum.Font.GothamBold, Name="Title"}), "Text"),
				AddThemeObject(SetProps(MakeElement("Label","",13), {Size=UDim2.new(1,-24,0,0), Position=UDim2.new(0,12,0,26), Font=Enum.Font.GothamSemibold, Name="Content", TextWrapped=true}), "TextDark"),
				AddThemeObject(MakeElement("Stroke"), "Stroke")
			}), "Second")
			AddConnection(f.Content:GetPropertyChangedSignal("Text"), function()
				f.Content.Size = UDim2.new(1,-24,0,f.Content.TextBounds.Y)
				f.Size = UDim2.new(1,0,0, f.Content.TextBounds.Y + 35)
			end)
			f.Content.Text = content
			return { Set=function(_,t) f.Content.Text=t end }
		end

		function E:AddButton(cfgB)
			cfgB = cfgB or {}; cfgB.Name = cfgB.Name or "Button"; cfgB.Icon = cfgB.Icon or "mouse-pointer"; cfgB.Callback = cfgB.Callback or function() end
			local Click = SetProps(MakeElement("Button"), {Size=UDim2.new(1,0,1,0)})
			local f = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1),0,5), {
				Parent=ItemParent, Size=UDim2.new(1,0,0,33)
			}), {
				AddThemeObject(SetProps(MakeElement("Label", cfgB.Name, 15), {Size=UDim2.new(1,-12,1,0), Position=UDim2.new(0,12,0,0), Font=Enum.Font.GothamBold, Name="Content"}), "Text"),
				AddThemeObject(SetProps(MakeElement("Image", cfgB.Icon), {Size=UDim2.new(0,20,0,20), Position=UDim2.new(1,-30,0,7)}), "TextDark"),
				AddThemeObject(MakeElement("Stroke"), "Stroke"),
				Click
			}), "Second")
			Click.MouseEnter:Connect(function()
				TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3 = Color3.fromRGB(IkanTongkolLib.Themes.Default.Second.R*255+3, IkanTongkolLib.Themes.Default.Second.G*255+3, IkanTongkolLib.Themes.Default.Second.B*255+3)}):Play()
			end)
			Click.MouseLeave:Connect(function()
				TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3 = IkanTongkolLib.Themes.Default.Second}):Play()
			end)
			Click.MouseButton1Down:Connect(function()
				TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3 = Color3.fromRGB(IkanTongkolLib.Themes.Default.Second.R*255+6, IkanTongkolLib.Themes.Default.Second.G*255+6, IkanTongkolLib.Themes.Default.Second.B*255+6)}):Play()
			end)
			Click.MouseButton1Up:Connect(function()
				TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3 = Color3.fromRGB(IkanTongkolLib.Themes.Default.Second.R*255+3, IkanTongkolLib.Themes.Default.Second.G*255+3, IkanTongkolLib.Themes.Default.Second.B*255+3)}):Play()
				task.spawn(cfgB.Callback)
			end)
			return { Set=function(_,t) f.Content.Text = t end }
		end

		function E:AddToggle(cfgT)
			cfgT = cfgT or {}
			cfgT.Name = cfgT.Name or "Toggle"
			cfgT.Default = cfgT.Default or false
			cfgT.Color = cfgT.Color or Color3.fromRGB(9,99,195)
			cfgT.Callback = cfgT.Callback or function() end
			local t = {Value = cfgT.Default, Save = cfgT.Save}
			local Click = SetProps(MakeElement("Button"), {Size=UDim2.new(1,0,1,0)})
			local box = SetChildren(SetProps(MakeElement("RoundFrame", cfgT.Color, 0, 4), {
				Size=UDim2.new(0,24,0,24), Position=UDim2.new(1,-24,0.5,0), AnchorPoint=Vector2.new(0.5,0.5)
			}), {
				SetProps(MakeElement("Stroke"), {Color=cfgT.Color, Name="Stroke", Transparency=0.5}),
				SetProps(MakeElement("Image", "rbxassetid://3944680095"), {Size=UDim2.new(0,20,0,20), AnchorPoint=Vector2.new(0.5,0.5), Position=UDim2.new(0.5,0,0.5,0), ImageColor3=Color3.new(1,1,1), Name="Ico"})
			})
			local f = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1), 0, 5), {
				Parent=ItemParent, Size=UDim2.new(1,0,0,38)
			}), {
				AddThemeObject(SetProps(MakeElement("Label", cfgT.Name, 15), {Size=UDim2.new(1,-12,1,0), Position=UDim2.new(0,12,0,0), Font=Enum.Font.GothamBold, Name="Content"}), "Text"),
				AddThemeObject(MakeElement("Stroke"), "Stroke"),
				box, Click
			}), "Second")
			function t:Set(v)
				t.Value = v
				TweenService:Create(box, TweenInfo.new(.3, Enum.EasingStyle.Quint), {BackgroundColor3 = v and cfgT.Color or IkanTongkolLib.Themes.Default.Divider}):Play()
				TweenService:Create(box.Stroke, TweenInfo.new(.3, Enum.EasingStyle.Quint), {Color = v and cfgT.Color or IkanTongkolLib.Themes.Default.Stroke}):Play()
				TweenService:Create(box.Ico, TweenInfo.new(.3, Enum.EasingStyle.Quint), {ImageTransparency = v and 0 or 1, Size = v and UDim2.new(0,20,0,20) or UDim2.new(0,8,0,8)}):Play()
				cfgT.Callback(t.Value)
			end
			t:Set(t.Value)
			Click.MouseEnter:Connect(function() TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3=Color3.fromRGB(35,35,35)}):Play() end)
			Click.MouseLeave:Connect(function() TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3=IkanTongkolLib.Themes.Default.Second}):Play() end)
			Click.MouseButton1Down:Connect(function() TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3=Color3.fromRGB(38,38,38)}):Play() end)
			Click.MouseButton1Up:Connect(function()
				TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3=Color3.fromRGB(35,35,35)}):Play()
				if cfgT.Flag then IkanTongkolLib.Flags[cfgT.Flag] = t; if IkanTongkolLib.SaveCfg then SaveCfg(game.GameId) end end
				t:Set(not t.Value)
			end)
			if cfgT.Flag then IkanTongkolLib.Flags[cfgT.Flag] = t end
			return t
		end

		function E:AddSlider(cfgS)
			cfgS = cfgS or {}
			cfgS.Name = cfgS.Name or "Slider"; cfgS.Min = cfgS.Min or 0; cfgS.Max = cfgS.Max or 100
			cfgS.Increment = cfgS.Increment or 1; cfgS.Default = cfgS.Default or 50
			cfgS.ValueName = cfgS.ValueName or ""; cfgS.Color = cfgS.Color or Color3.fromRGB(9,149,98)
			cfgS.Callback = cfgS.Callback or function() end
			local s = {Value = cfgS.Default, Save = cfgS.Save}

			local drag = SetChildren(SetProps(MakeElement("RoundFrame", cfgS.Color, 0, 5), {Size=UDim2.new(0,0,1,0), BackgroundTransparency=0.3, ClipsDescendants=true}), {
				AddThemeObject(SetProps(MakeElement("Label","",13), {Size=UDim2.new(1,-12,0,14), Position=UDim2.new(0,12,0,6), Font=Enum.Font.GothamBold, Name="Value", TextTransparency=0}), "Text")
			})
			local bar = SetChildren(SetProps(MakeElement("RoundFrame", cfgS.Color, 0, 5), {Size=UDim2.new(1,-24,0,26), Position=UDim2.new(0,12,0,30), BackgroundTransparency=0.9}), {
				SetProps(MakeElement("Stroke"), {Color=cfgS.Color}),
				AddThemeObject(SetProps(MakeElement("Label","",13), {Size=UDim2.new(1,-12,0,14), Position=UDim2.new(0,12,0,6), Font=Enum.Font.GothamBold, Name="Value", TextTransparency=0.8}), "Text"),
				drag
			})
			local f = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1),0,4), {Parent=ItemParent, Size=UDim2.new(1,0,0,65)}), {
				AddThemeObject(SetProps(MakeElement("Label", cfgS.Name, 15), {Size=UDim2.new(1,-12,0,14), Position=UDim2.new(0,12,0,10), Font=Enum.Font.GothamBold}), "Text"),
				AddThemeObject(MakeElement("Stroke"), "Stroke"), bar
			}), "Second")

			local dragging = false
			bar.InputBegan:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = true end end)
			bar.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 then dragging = false end end)
			UserInputService.InputChanged:Connect(function(i)
				if dragging and i.UserInputType == Enum.UserInputType.MouseMovement then
					local t = math.clamp((i.Position.X - bar.AbsolutePosition.X)/bar.AbsoluteSize.X, 0, 1)
					s:Set(cfgS.Min + ((cfgS.Max - cfgS.Min) * t)); if IkanTongkolLib.SaveCfg then SaveCfg(game.GameId) end
				end
			end)
			function s:Set(val)
				self.Value = math.clamp(Round(val, cfgS.Increment), cfgS.Min, cfgS.Max)
				TweenService:Create(drag, TweenInfo.new(.15, Enum.EasingStyle.Quad), {Size = UDim2.fromScale((self.Value - cfgS.Min)/(cfgS.Max-cfgS.Min), 1)}):Play()
				local txt = tostring(self.Value).." "..cfgS.ValueName
				bar.Value.Text, drag.Value.Text = txt, txt
				cfgS.Callback(self.Value)
			end
			s:Set(s.Value)
			if cfgS.Flag then IkanTongkolLib.Flags[cfgS.Flag] = s end
			return s
		end

		function E:AddDropdown(cfgD)
			cfgD = cfgD or {}
			cfgD.Name = cfgD.Name or "Dropdown"; cfgD.Options = cfgD.Options or {}; cfgD.Default = cfgD.Default or ""
			cfgD.Callback = cfgD.Callback or function() end
			local d = {Value = cfgD.Default, Options = cfgD.Options, Buttons = {}, Toggled = false, Type="Dropdown", Save = cfgD.Save}
			if not table.find(d.Options, d.Value) then d.Value = "..." end
			local list = MakeElement("List")
			local inner = AddThemeObject(SetProps(SetChildren(MakeElement("ScrollFrame", Color3.fromRGB(40,40,40),4), {list}), {ClipsDescendants=true, Size=UDim2.new(1,0,1,-38), Position=UDim2.new(0,0,0,38)}), "Divider")
			local Click = SetProps(MakeElement("Button"), {Size=UDim2.new(1,0,1,0)})
			local frame = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1),0,5), {Parent=ItemParent, Size=UDim2.new(1,0,0,38)}), {
				inner,
				SetProps(SetChildren(MakeElement("TFrame"), {
					AddThemeObject(SetProps(MakeElement("Label", cfgD.Name, 15), {Size=UDim2.new(1,-12,1,0), Position=UDim2.new(0,12,0,0), Font=Enum.Font.GothamBold, Name="Content"}), "Text"),
					AddThemeObject(SetProps(MakeElement("Image", "rbxassetid://7072706796"), {Size=UDim2.new(0,20,0,20), AnchorPoint=Vector2.new(0,0.5), Position=UDim2.new(1,-30,0.5,0), ImageColor3=Color3.fromRGB(240,240,240), Name="Ico"}), "TextDark"),
					AddThemeObject(SetProps(MakeElement("Label", "Selected", 13), {Size=UDim2.new(1,-40,1,0), Font=Enum.Font.Gotham, Name="Selected", TextXAlignment=Enum.TextXAlignment.Right}), "TextDark"),
					AddThemeObject(SetProps(MakeElement("Frame"), {Size=UDim2.new(1,0,0,1), Position=UDim2.new(0,0,1,-1), Name="Line", Visible=false}), "Stroke"),
					Click
				}), {Size=UDim2.new(1,0,0,38), ClipsDescendants=true, Name="F"}),
				AddThemeObject(MakeElement("Stroke"), "Stroke"), MakeElement("Corner")
			}), "Second")

			AddConnection(list:GetPropertyChangedSignal("AbsoluteContentSize"), function()
				inner.CanvasSize = UDim2.new(0,0,0, list.AbsoluteContentSize.Y)
			end)

			local function addOptions(opts)
				for _,opt in ipairs(opts) do
					local btn = AddThemeObject(SetProps(SetChildren(MakeElement("Button"), {
						MakeElement("Corner",0,6),
						AddThemeObject(SetProps(MakeElement("Label", opt, 13, 0.4), {Position=UDim2.new(0,8,0,0), Size=UDim2.new(1,-8,1,0), Name="Title"}), "Text")
					}), {Parent=inner, Size=UDim2.new(1,0,0,28), BackgroundTransparency=1, ClipsDescendants=true}), "Divider")
					btn.MouseButton1Click:Connect(function()
						d:Set(opt); if IkanTongkolLib.SaveCfg then SaveCfg(game.GameId) end
					end)
					d.Buttons[opt] = btn
				end
			end
			function d:Refresh(opts, delete)
				if delete then
					for _,b in pairs(self.Buttons) do b:Destroy() end
					self.Buttons = {}; self.Options = {}
				end
				self.Options = opts; addOptions(self.Options)
			end
			function d:Set(val)
				if not table.find(self.Options, val) then
					self.Value = "..."; frame.F.Selected.Text = self.Value
					for _, b in pairs(self.Buttons) do
						TweenService:Create(b, TweenInfo.new(.15, Enum.EasingStyle.Quad), {BackgroundTransparency=1}):Play()
						TweenService:Create(b.Title, TweenInfo.new(.15, Enum.EasingStyle.Quad), {TextTransparency=0.4}):Play()
					end
					return
				end
				self.Value = val; frame.F.Selected.Text = val
				for _, b in pairs(self.Buttons) do
					TweenService:Create(b, TweenInfo.new(.15, Enum.EasingStyle.Quad), {BackgroundTransparency=1}):Play()
					TweenService:Create(b.Title, TweenInfo.new(.15, Enum.EasingStyle.Quad), {TextTransparency=0.4}):Play()
				end
				local b = self.Buttons[val]
				if b then
					TweenService:Create(b, TweenInfo.new(.15, Enum.EasingStyle.Quad), {BackgroundTransparency=0}):Play()
					TweenService:Create(b.Title, TweenInfo.new(.15, Enum.EasingStyle.Quad), {TextTransparency=0}):Play()
				end
				cfgD.Callback(self.Value)
			end
			Click.MouseButton1Click:Connect(function()
				d.Toggled = not d.Toggled; frame.F.Line.Visible = d.Toggled
				local max = 5; local h = list.AbsoluteContentSize.Y
				local size = ( #d.Options > max ) and (38 + max*28) or (38 + h)
				TweenService:Create(frame, TweenInfo.new(.15, Enum.EasingStyle.Quad), {Size = d.Toggled and UDim2.new(1,0,0,size) or UDim2.new(1,0,0,38)}):Play()
				local ico = frame.F.Ico; if ico then TweenService:Create(ico, TweenInfo.new(.15, Enum.EasingStyle.Quad), {Rotation = d.Toggled and 180 or 0}):Play() end
			end)
			d:Refresh(d.Options, false); d:Set(d.Value)
			if cfgD.Flag then IkanTongkolLib.Flags[cfgD.Flag] = d end
			return d
		end

		function E:AddBind(cfgB)
			cfgB = cfgB or {}
			cfgB.Name = cfgB.Name or "Bind"; cfgB.Default = cfgB.Default or Enum.KeyCode.Unknown
			cfgB.Hold = cfgB.Hold or false; cfgB.Callback = cfgB.Callback or function() end
			local bind = {Value = nil, Binding=false, Type="Bind", Save=cfgB.Save}
			local holding = false
			local Click = SetProps(MakeElement("Button"), {Size=UDim2.new(1,0,1,0)})
			local box = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1), 0, 4), {
				Size=UDim2.new(0,24,0,24), Position=UDim2.new(1,-12,0.5,0), AnchorPoint=Vector2.new(1,0.5)
			}), {
				AddThemeObject(MakeElement("Stroke"), "Stroke"),
				AddThemeObject(SetProps(MakeElement("Label", cfgB.Name, 14), {Size=UDim2.new(1,0,1,0), Font=Enum.Font.GothamBold, TextXAlignment=Enum.TextXAlignment.Center, Name="Value"}), "Text")
			}), "Main")
			local f = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1),0,5), {Parent=ItemParent, Size=UDim2.new(1,0,0,38)}), {
				AddThemeObject(SetProps(MakeElement("Label", cfgB.Name, 15), {Size=UDim2.new(1,-12,1,0), Position=UDim2.new(0,12,0,0), Font=Enum.Font.GothamBold, Name="Content"}), "Text"),
				AddThemeObject(MakeElement("Stroke"), "Stroke"),
				box, Click
			}), "Second")

			AddConnection(box.Value:GetPropertyChangedSignal("Text"), function()
				TweenService:Create(box, TweenInfo.new(.25, Enum.EasingStyle.Quint), {Size=UDim2.new(0, box.Value.TextBounds.X+16, 0, 24)}):Play()
			end)

			Click.InputEnded:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseButton1 then
					if bind.Binding then return end
					bind.Binding = true; box.Value.Text = ""
				end
			end)

			AddConnection(UserInputService.InputBegan, function(input)
				if UserInputService:GetFocusedTextBox() then return end
				if (input.KeyCode.Name == bind.Value or input.UserInputType.Name == bind.Value) and not bind.Binding then
					if cfgB.Hold then holding = true; cfgB.Callback(holding) else cfgB.Callback() end
				elseif bind.Binding then
					local key
					pcall(function() if not CheckKey(BlacklistedKeys, input.KeyCode) then key = input.KeyCode end end)
					pcall(function() if CheckKey(WhitelistedMouse, input.UserInputType) and not key then key = input.UserInputType end end)
					key = key or bind.Value
					bind:Set(key)
					if IkanTongkolLib.SaveCfg then SaveCfg(game.GameId) end
				end
			end)
			AddConnection(UserInputService.InputEnded, function(input)
				if (input.KeyCode.Name == bind.Value or input.UserInputType.Name == bind.Value) and cfgB.Hold and holding then
					holding = false; cfgB.Callback(holding)
				end
			end)

			function bind:Set(key)
				self.Binding = false
				self.Value = key or self.Value
				self.Value = self.Value.Name or self.Value
				box.Value.Text = self.Value
			end

			bind:Set(cfgB.Default)
			if cfgB.Flag then IkanTongkolLib.Flags[cfgB.Flag] = bind end
			return bind
		end

		function E:AddTextbox(cfgT)
			cfgT = cfgT or {}
			cfgT.Name = cfgT.Name or "Textbox"; cfgT.Default = cfgT.Default or ""; cfgT.TextDisappear = cfgT.TextDisappear or false
			cfgT.Callback = cfgT.Callback or function() end
			local Click = SetProps(MakeElement("Button"), {Size=UDim2.new(1,0,1,0)})
			local actual = AddThemeObject(Create("TextBox", {
				Size=UDim2.new(1,0,1,0), BackgroundTransparency=1, TextColor3=Color3.new(1,1,1),
				PlaceholderColor3=Color3.fromRGB(210,210,210), PlaceholderText="Input", Font=Enum.Font.GothamSemibold,
				TextXAlignment=Enum.TextXAlignment.Center, TextSize=14, ClearTextOnFocus=false
			}), "Text")
			local box = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1),0,4), {
				Size=UDim2.new(0,24,0,24), Position=UDim2.new(1,-12,0.5,0), AnchorPoint=Vector2.new(1,0.5)
			}), { AddThemeObject(MakeElement("Stroke"), "Stroke"), actual }), "Main")
			local f = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1),0,5), {Parent=ItemParent, Size=UDim2.new(1,0,0,38)}), {
				AddThemeObject(SetProps(MakeElement("Label", cfgT.Name, 15), {Size=UDim2.new(1,-12,1,0), Position=UDim2.new(0,12,0,0), Font=Enum.Font.GothamBold, Name="Content"}), "Text"),
				AddThemeObject(MakeElement("Stroke"), "Stroke"), box, Click
			}), "Second")
			AddConnection(actual:GetPropertyChangedSignal("Text"), function()
				TweenService:Create(box, TweenInfo.new(.45, Enum.EasingStyle.Quint), {Size=UDim2.new(0, actual.TextBounds.X + 16, 0, 24)}):Play()
			end)
			actual.FocusLost:Connect(function()
				cfgT.Callback(actual.Text)
				if cfgT.TextDisappear then actual.Text = "" end
			end)
			actual.Text = cfgT.Default
			Click.MouseEnter:Connect(function() TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3=Color3.fromRGB(35,35,35)}):Play() end)
			Click.MouseLeave:Connect(function() TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3=IkanTongkolLib.Themes.Default.Second}):Play() end)
			Click.MouseButton1Up:Connect(function()
				TweenService:Create(f, TweenInfo.new(.25, Enum.EasingStyle.Quint), {BackgroundColor3=Color3.fromRGB(35,35,35)}):Play()
				actual:CaptureFocus()
			end)
		end

		function E:AddColorpicker(cfgC)
			cfgC = cfgC or {}
			cfgC.Name = cfgC.Name or "Colorpicker"; cfgC.Default = cfgC.Default or Color3.new(1,1,1)
			cfgC.Callback = cfgC.Callback or function() end
			local H,S,V = Color3.toHSV(cfgC.Default); H = H == H and H or 1; S = S == S and S or 1; V = V == V and V or 1
			local cp = {Value = cfgC.Default, Toggled=false, Type="Colorpicker", Save=cfgC.Save}

			local sel = Create("ImageLabel", {Size=UDim2.new(0,18,0,18), ScaleType=Enum.ScaleType.Fit, AnchorPoint=Vector2.new(0.5,0.5), BackgroundTransparency=1, Image="http://www.roblox.com/asset/?id=4805639000"})
			local hueSel = Create("ImageLabel", {Size=UDim2.new(0,18,0,18), ScaleType=Enum.ScaleType.Fit, AnchorPoint=Vector2.new(0.5,0.5), BackgroundTransparency=1, Image="http://www.roblox.com/asset/?id=4805639000"})

			local Color = Create("ImageLabel", {Size=UDim2.new(1,-25,1,0), Visible=false, Image="rbxassetid://4155801252"}, {Create("UICorner",{CornerRadius=UDim.new(0,5)}), sel})
			local Hue   = Create("Frame", {Size=UDim2.new(0,20,1,0), Position=UDim2.new(1,-20,0,0), Visible=false}, {
				Create("UIGradient", {Rotation=270, Color = ColorSequence.new{
					ColorSequenceKeypoint.new(0.00, Color3.fromRGB(255,0,4)),
					ColorSequenceKeypoint.new(0.20, Color3.fromRGB(234,255,0)),
					ColorSequenceKeypoint.new(0.40, Color3.fromRGB(21,255,0)),
					ColorSequenceKeypoint.new(0.60, Color3.fromRGB(0,255,255)),
					ColorSequenceKeypoint.new(0.80, Color3.fromRGB(0,17,255)),
					ColorSequenceKeypoint.new(0.90, Color3.fromRGB(255,0,251)),
					ColorSequenceKeypoint.new(1.00, Color3.fromRGB(255,0,4))
				}}),
				Create("UICorner", {CornerRadius=UDim.new(0,5)}),
				hueSel
			})

			local inner = Create("Frame", {Position=UDim2.new(0,0,0,32), Size=UDim2.new(1,0,1,-32), BackgroundTransparency=1, ClipsDescendants=true}, {
				Hue, Color, Create("UIPadding", {PaddingLeft=UDim.new(0,35), PaddingRight=UDim.new(0,35), PaddingBottom=UDim.new(0,10), PaddingTop=UDim.new(0,17)})
			})

			local Click = SetProps(MakeElement("Button"), {Size=UDim2.new(1,0,1,0)})
			local box = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1),0,4), {Size=UDim2.new(0,24,0,24), Position=UDim2.new(1,-12,0.5,0), AnchorPoint=Vector2.new(1,0.5)}), {
				AddThemeObject(MakeElement("Stroke"), "Stroke")
			}), "Main")
			local f = AddThemeObject(SetChildren(SetProps(MakeElement("RoundFrame", Color3.new(1,1,1),0,5), {Parent=ItemParent, Size=UDim2.new(1,0,0,38)}), {
				SetProps(SetChildren(MakeElement("TFrame"), {
					AddThemeObject(SetProps(MakeElement("Label", cfgC.Name, 15), {Size=UDim2.new(1,-12,1,0), Position=UDim2.new(0,12,0,0), Font=Enum.Font.GothamBold, Name="Content"}), "Text"),
					box, Click,
					AddThemeObject(SetProps(MakeElement("Frame"), {Size=UDim2.new(1,0,0,1), Position=UDim2.new(0,0,1,-1), Name="Line", Visible=false}), "Stroke"),
				}), {Size=UDim2.new(1,0,0,38), ClipsDescendants=true, Name="F"}),
				inner, AddThemeObject(MakeElement("Stroke"), "Stroke")
			}), "Second")

			local function update()
				box.BackgroundColor3 = Color3.fromHSV(H,S,V)
				Color.BackgroundColor3 = Color3.fromHSV(H,1,1)
				cp:Set(box.BackgroundColor3)
				cfgC.Callback(box.BackgroundColor3)
				if IkanTongkolLib.SaveCfg then SaveCfg(game.GameId) end
			end
			-- initial selector positions
			task.defer(function()
				hueSel.Position = UDim2.new(0.5,0, 1-H, 0)
				sel.Position    = UDim2.new(S,0, 1-V, 0)
			end)

			Click.MouseButton1Click:Connect(function()
				cp.Toggled = not cp.Toggled
				TweenService:Create(f, TweenInfo.new(.15, Enum.EasingStyle.Quad), {Size = cp.Toggled and UDim2.new(1,0,0,148) or UDim2.new(1,0,0,38)}):Play()
				Color.Visible = cp.Toggled; Hue.Visible = cp.Toggled; f.F.Line.Visible = cp.Toggled
			end)

			local colorConn, hueConn
			Color.InputBegan:Connect(function(i)
				if i.UserInputType == Enum.UserInputType.MouseButton1 then
					if colorConn then colorConn:Disconnect() end
					colorConn = RunService.RenderStepped:Connect(function()
						local x = math.clamp(Mouse.X - Color.AbsolutePosition.X, 0, Color.AbsoluteSize.X)/Color.AbsoluteSize.X
						local y = math.clamp(Mouse.Y - Color.AbsolutePosition.Y, 0, Color.AbsoluteSize.Y)/Color.AbsoluteSize.Y
						sel.Position = UDim2.new(x,0,y,0); S = x; V = 1 - y; update()
					end)
				end
			end)
			Color.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 and colorConn then colorConn:Disconnect() end end)

			Hue.InputBegan:Connect(function(i)
				if i.UserInputType == Enum.UserInputType.MouseButton1 then
					if hueConn then hueConn:Disconnect() end
					hueConn = RunService.RenderStepped:Connect(function()
						local y = math.clamp(Mouse.Y - Hue.AbsolutePosition.Y, 0, Hue.AbsoluteSize.Y)/Hue.AbsoluteSize.Y
						hueSel.Position = UDim2.new(0.5,0,y,0); H = 1 - y; update()
					end)
				end
			end)
			Hue.InputEnded:Connect(function(i) if i.UserInputType == Enum.UserInputType.MouseButton1 and hueConn then hueConn:Disconnect() end end)

			function cp:Set(v) cp.Value = v; box.BackgroundColor3 = v; cfgC.Callback(v) end
			cp:Set(cp.Value)
			if cfgC.Flag then IkanTongkolLib.Flags[cfgC.Flag] = cp end
			return cp
		end

		-- Section (opsional untuk grouping)
		function E:AddSection(cfgS)
			cfgS = cfgS or {}; cfgS.Name = cfgS.Name or "Section"
			local frame = SetChildren(SetProps(MakeElement("TFrame"), {Parent=ItemParent, Size=UDim2.new(1,0,0,26)}), {
				AddThemeObject(SetProps(MakeElement("Label", cfgS.Name, 14), {Size=UDim2.new(1,-12,0,16), Position=UDim2.new(0,0,0,3), Font=Enum.Font.GothamSemibold}), "TextDark"),
				SetChildren(SetProps(MakeElement("TFrame"), {AnchorPoint=Vector2.new(0,0), Size=UDim2.new(1,0,1,-24), Position=UDim2.new(0,0,0,23), Name="Holder"}), {MakeElement("List", 0, 6)})
			})
			AddConnection(frame.Holder.UIListLayout:GetPropertyChangedSignal("AbsoluteContentSize"), function()
				frame.Size = UDim2.new(1,0,0, frame.Holder.UIListLayout.AbsoluteContentSize.Y + 31)
				frame.Holder.Size = UDim2.new(1,0,0, frame.Holder.UIListLayout.AbsoluteContentSize.Y)
			end)
			local S = {}
			for k,v in next, GetElements(frame.Holder) do S[k] = v end
			return S
		end

		return E
	end

	local API = {}
	for k,v in next, GetElements(Container) do API[k] = v end

	-- Salam kecil: siap dipakai
	IkanTongkolLib:MakeNotification({Name="IkanTongkol", Content="UI siap dipakai.", Time=3})

	return API
end

function IkanTongkolLib:Destroy() Root:Destroy() end

return IkanTongkolLib


